## [Algorithm] 오늘 푼 문제

##### [사회망 서비스(SNS)](https://www.acmicpc.net/problem/2533) 
그래프가 트리로 주어진다. 트리는 간선의 정보가 무방향으로 주어지고 사이클이 없기 때문에 루트 노드는 어떤 노드를 선택해도 서브트리의 모양만 달라질 뿐, 트리 구조가 가능하다. 

이 문제에선 
- 내가 얼리 어답터라면 → 자식 노드는 얼리 어답터일 수도 있고 아닐 수도 있다.
- 내가 얼리 어답터가 아니라면 → 자식 노드는 반드시 얼리 어답터여야 한다.

따라서 자식 노드들의 최적해를 이용해 부모 노드의 최적해를 구할 수 있고, 트리는 DFS를 통해 모든 노드를 탐색할 때, 동일한 서브트리를 반복해서 계산하면 비효율적이므로 여기서는 DP를 이용한다.

`dp[node][0]`: `node`가 얼리 어답터가 아닐 때 최소 얼리 어답터 수
`dp[node][1]`: `node`가 얼리 어답터일 때 최소 얼리 어답터 수

##### [Puyo Puyo](https://www.acmicpc.net/problem/11559)

BFS를 활용한 구현 문제다. 테트리스와 비슷한 게임인데 4칸 이상이 같은 색일 경우를 BFS로 탐색하고 그 칸들을 빈칸으로 만든다. 그리고 빈칸을 채워야 한다. 이때 유의할 점은 열 기준으로 반복하면서 빈칸이 존재하면 모든 행에 대하여 칸 이동을 해야된다는 점이다.

```java
private static void fall() {
    for (int j = 0; j < 6; j++) {
        for (int i = 11; i >= 1; i--) {
            if (field[i][j] == '.') {  //빈칸일 경우
                for (int k = i - 1; k >= 0; k--) {  //윗칸 중에 빈칸이 아닌 칸을 한칸씩 내린다.
                    if (field[k][j] != '.') {
                        field[i][j] = field[k][j];
                        field[k][j] = '.';
                        break;
                    }
                }
            }
        }
    }
}
```

## [Spring] MDC

MDC(Mapped Diagnostic Context)에 대해 공부했지만 구체적으로 언제 사용하는 건지? 그냥 모든 요청마다 고유한 식별자를 넣어서 같은 요청에 대한 로그를 구분하는건가? 하는 궁금증이 있어서 언제 사용하는 지에 대해 찾아보았다.

우선 MDC는 `ThreadLocal` 기반으로 동작하기 때문에 멀티스레드 환경에서 각 스레드 별 구분이 필요할 때 사용할 수 있다. 또한 앞서 말한 것처럼 `Filter`에서 설정하여 요청별 고유 식별 값을 넣을 수도 있고, 비슷하게 사용자 정보를 넣을 수도 있다.

하지만 무조건 MDC를 사용해야 좋은건 아니다. 반대로 컨텍스트 정보가 필요해서 MDC를 사용하는 것이다. 비동기로 알림을 발송하다가 특정 알림 발송이 실패했다고 가정해보자. 기본 로그는 스레드 이름만 제공하므로 어떤 알림이 문제인지 파악하기 어렵다. 이때 MDC에 `requestId` 같은 고유 식별자를 추가하면 실패 지점을 쉽게 연결해 분석할 수 있다.

또한 특정 사용자의 행동(로그인, 주문, 결제 등)을 로그로 분석하고 싶을 때, MDC에 `userId`를 추가해 사용자별 로그를 구분할 수 있다.

그리고 복잡한 비즈니스 로직(ex. 주문 -> 결제 -> 배송 -> 완료)에서 기본 로그만으로는 흐름을 파악하기 힘들기 때문에 MDC에 `orderId`를 추가해 전체 흐름을 추적할 수 있다.

결록적으로 MDC는 로그에 컨텍스트 정보를 추가해 로그 트래킹과 가독성을 높이고 싶을 때 사용하는 것이다. 기본 로그로 문제를 파악하기 힘들 때 MDC를 도입할 수 있을 것이다.

***

[#algorithm](https://github.com/wda067/TIL/search?q=%23algorithm&type=code)
[#spring](https://github.com/wda067/TIL/search?q=%23spring&type=code)